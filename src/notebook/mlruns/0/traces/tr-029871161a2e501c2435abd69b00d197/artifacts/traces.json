{"spans": [{"trace_id": "AphxFhouUBwkNavWmwDRlw==", "span_id": "kBTIScGZOrU=", "parent_span_id": null, "name": "LangGraph", "start_time_unix_nano": 1762294479952967000, "end_time_unix_nano": 1762294486268687000, "events": [{"name": "exception", "time_unix_nano": 1762294486268653, "attributes": {"exception.message": "At key 'success': Can receive only one value per step. Use an Annotated key to handle multiple values.\nFor troubleshooting, visit: https://docs.langchain.com/oss/python/langgraph/errors/INVALID_CONCURRENT_GRAPH_UPDATE", "exception.type": "InvalidUpdateError", "exception.stacktrace": "Traceback (most recent call last):\n  File \"/Users/viniciusgribas/Code/github/work/teste_alvorada_dev/.venv/lib/python3.12/site-packages/langgraph/pregel/main.py\", line 2689, in stream\n    loop.after_tick()\n  File \"/Users/viniciusgribas/Code/github/work/teste_alvorada_dev/.venv/lib/python3.12/site-packages/langgraph/pregel/_loop.py\", line 545, in after_tick\n    self.updated_channels = apply_writes(\n                            ^^^^^^^^^^^^^\n  File \"/Users/viniciusgribas/Code/github/work/teste_alvorada_dev/.venv/lib/python3.12/site-packages/langgraph/pregel/_algo.py\", line 294, in apply_writes\n    if channels[chan].update(vals) and next_version is not None:\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/viniciusgribas/Code/github/work/teste_alvorada_dev/.venv/lib/python3.12/site-packages/langgraph/channels/last_value.py\", line 64, in update\n    raise InvalidUpdateError(msg)\nlanggraph.errors.InvalidUpdateError: At key 'success': Can receive only one value per step. Use an Annotated key to handle multiple values.\nFor troubleshooting, visit: https://docs.langchain.com/oss/python/langgraph/errors/INVALID_CONCURRENT_GRAPH_UPDATE"}}], "status": {"code": "STATUS_CODE_ERROR", "message": "At key 'success': Can receive only one value per step. Use an Annotated key to handle multiple values.\nFor troubleshooting, visit: https://docs.langchain.com/oss/python/langgraph/errors/INVALID_CONCURRENT_GRAPH_UPDATE"}, "attributes": {"mlflow.traceRequestId": "\"tr-029871161a2e501c2435abd69b00d197\"", "mlflow.spanType": "\"CHAIN\"", "mlflow.spanInputs": "{\"contract_input_path\": \"/Users/viniciusgribas/Code/github/work/teste_alvorada_dev/data/input/jordan_book\", \"invoice_input_path\": \"/Users/viniciusgribas/Code/github/work/teste_alvorada_dev/data/input/invoice_dataset\", \"receipt_input_path\": \"/Users/viniciusgribas/Code/github/work/teste_alvorada_dev/data/input/receipts_dataset\"}"}}, {"trace_id": "AphxFhouUBwkNavWmwDRlw==", "span_id": "SgDFUZG0Vng=", "parent_span_id": "kBTIScGZOrU=", "name": "extract_contracts", "start_time_unix_nano": 1762294479958649000, "end_time_unix_nano": 1762294479972402000, "events": [], "status": {"code": "STATUS_CODE_OK", "message": ""}, "attributes": {"mlflow.traceRequestId": "\"tr-029871161a2e501c2435abd69b00d197\"", "mlflow.spanType": "\"CHAIN\"", "mlflow.spanInputs": "{\"contract_input_path\": \"/Users/viniciusgribas/Code/github/work/teste_alvorada_dev/data/input/jordan_book\", \"invoice_input_path\": \"/Users/viniciusgribas/Code/github/work/teste_alvorada_dev/data/input/invoice_dataset\", \"receipt_input_path\": \"/Users/viniciusgribas/Code/github/work/teste_alvorada_dev/data/input/receipts_dataset\"}", "metadata": "{\"langgraph_step\": 1, \"langgraph_node\": \"extract_contracts\", \"langgraph_triggers\": [\"branch:to:extract_contracts\"], \"langgraph_path\": [\"__pregel_pull\", \"extract_contracts\"], \"langgraph_checkpoint_ns\": \"extract_contracts:2aa700b8-5511-37b0-f678-1be80106a09e\"}", "mlflow.spanOutputs": "{\"contract_sections_df\": \"Empty DataFrame\\nColumns: []\\nIndex: []\", \"success\": false, \"errors\": [\"'NoneType' object has no attribute 'seek'\"]}"}}, {"trace_id": "AphxFhouUBwkNavWmwDRlw==", "span_id": "jQxY0C7oYNg=", "parent_span_id": "SgDFUZG0Vng=", "name": "extract_contract_sections_node", "start_time_unix_nano": 1762294479959293000, "end_time_unix_nano": 1762294479970558000, "events": [], "status": {"code": "STATUS_CODE_OK", "message": ""}, "attributes": {"mlflow.traceRequestId": "\"tr-029871161a2e501c2435abd69b00d197\"", "mlflow.spanType": "\"UNKNOWN\"", "mlflow.spanFunctionName": "\"extract_contract_sections_node\"", "mlflow.spanInputs": "{\"state\": {\"contract_input_path\": \"/Users/viniciusgribas/Code/github/work/teste_alvorada_dev/data/input/jordan_book\", \"invoice_input_path\": \"/Users/viniciusgribas/Code/github/work/teste_alvorada_dev/data/input/invoice_dataset\", \"receipt_input_path\": \"/Users/viniciusgribas/Code/github/work/teste_alvorada_dev/data/input/receipts_dataset\"}}", "mlflow.spanOutputs": "{\"contract_sections_df\": \"Empty DataFrame\\nColumns: []\\nIndex: []\", \"success\": false, \"errors\": [\"'NoneType' object has no attribute 'seek'\"]}"}}, {"trace_id": "AphxFhouUBwkNavWmwDRlw==", "span_id": "J6yjHqHpZ8M=", "parent_span_id": "kBTIScGZOrU=", "name": "extract_invoices", "start_time_unix_nano": 1762294479965620000, "end_time_unix_nano": 1762294486265255000, "events": [], "status": {"code": "STATUS_CODE_OK", "message": ""}, "attributes": {"mlflow.traceRequestId": "\"tr-029871161a2e501c2435abd69b00d197\"", "mlflow.spanType": "\"CHAIN\"", "mlflow.spanInputs": "{\"contract_input_path\": \"/Users/viniciusgribas/Code/github/work/teste_alvorada_dev/data/input/jordan_book\", \"invoice_input_path\": \"/Users/viniciusgribas/Code/github/work/teste_alvorada_dev/data/input/invoice_dataset\", \"receipt_input_path\": \"/Users/viniciusgribas/Code/github/work/teste_alvorada_dev/data/input/receipts_dataset\"}", "metadata": "{\"langgraph_step\": 1, \"langgraph_node\": \"extract_invoices\", \"langgraph_triggers\": [\"branch:to:extract_invoices\"], \"langgraph_path\": [\"__pregel_pull\", \"extract_invoices\"], \"langgraph_checkpoint_ns\": \"extract_invoices:263f7eb7-86a1-0bdd-b21d-b441c2699356\"}", "mlflow.spanOutputs": "{\"invoices_df\": \"          filename                                          file_path  \\\\\\n0  batch1-0001.jpg  /Users/viniciusgribas/Code/github/work/teste_a...   \\n1  batch1-0002.jpg  /Users/viniciusgribas/Code/github/work/teste_a...   \\n2  batch1-0003.jpg  /Users/viniciusgribas/Code/github/work/teste_a...   \\n3  batch1-0004.jpg  /Users/viniciusgribas/Code/github/work/teste_a...   \\n4  batch1-0005.jpg  /Users/viniciusgribas/Code/github/work/teste_a...   \\n5  batch1-0006.jpg  /Users/viniciusgribas/Code/github/work/teste_a...   \\n6  batch1-0007.jpg  /Users/viniciusgribas/Code/github/work/teste_a...   \\n7  batch1-0008.jpg  /Users/viniciusgribas/Code/github/work/teste_a...   \\n8  batch1-0009.jpg  /Users/viniciusgribas/Code/github/work/teste_a...   \\n9  batch1-0010.jpg  /Users/viniciusgribas/Code/github/work/teste_a...   \\n\\n  file_extension  file_size_kb  \\\\\\n0           .jpg    248.437500   \\n1           .jpg    215.474609   \\n2           .jpg    187.614258   \\n3           .jpg    216.333984   \\n4           .jpg    207.153320   \\n5           .jpg    192.469727   \\n6           .jpg    249.077148   \\n7           .jpg    203.968750   \\n8           .jpg    162.435547   \\n9           .jpg    170.107422   \\n\\n                                        cleaned_text  pages_count  \\\\\\n0  Invoice no: 51109338 Date of issue: Seller: An...            1   \\n1  Invoice no: 12847181 Date of issue: Seller: Fi...            1   \\n2  Invoice no: 19471831 Date of issue: Seller: Pa...            1   \\n3  Invoice no: 16273983 Date of issue: Seller: Re...            1   \\n4  Invoice no: 89969473 Date of issue: Seller: Jo...            1   \\n5  Invoice no: 72128555 Date of issue: Seller: Ob...            1   \\n6  Invoice no: 11580833 Date of issue: Seller: Wo...            1   \\n7  Invoice no: 74589240 Date of issue: Seller: Ha...            1   \\n8  Invoice no: 81978187 Date of issue: Seller: Pa...            1   \\n9  Invoice no: 99314100 Date of issue: 06/25/2014...            1   \\n\\n   extraction_method  text_length  success error  \\n0  OCR (pytesseract)         1198     True  None  \\n1  OCR (pytesseract)          976     True  None  \\n2  OCR (pytesseract)          810     True  None  \\n3  OCR (pytesseract)         1008     True  None  \\n4  OCR (pytesseract)          944     True  None  \\n5  OCR (pytesseract)          786     True  None  \\n6  OCR (pytesseract)         1200     True  None  \\n7  OCR (pytesseract)          907     True  None  \\n8  OCR (pytesseract)          587     True  None  \\n9  OCR (pytesseract)          649     True  None  \", \"success\": true, \"errors\": []}"}}, {"trace_id": "AphxFhouUBwkNavWmwDRlw==", "span_id": "tNufH5NGKHI=", "parent_span_id": "J6yjHqHpZ8M=", "name": "extract_invoices_node", "start_time_unix_nano": 1762294479966521000, "end_time_unix_nano": 1762294486263994000, "events": [], "status": {"code": "STATUS_CODE_OK", "message": ""}, "attributes": {"mlflow.traceRequestId": "\"tr-029871161a2e501c2435abd69b00d197\"", "mlflow.spanType": "\"UNKNOWN\"", "mlflow.spanFunctionName": "\"extract_invoices_node\"", "mlflow.spanInputs": "{\"state\": {\"contract_input_path\": \"/Users/viniciusgribas/Code/github/work/teste_alvorada_dev/data/input/jordan_book\", \"invoice_input_path\": \"/Users/viniciusgribas/Code/github/work/teste_alvorada_dev/data/input/invoice_dataset\", \"receipt_input_path\": \"/Users/viniciusgribas/Code/github/work/teste_alvorada_dev/data/input/receipts_dataset\"}}", "mlflow.spanOutputs": "{\"invoices_df\": \"          filename                                          file_path  \\\\\\n0  batch1-0001.jpg  /Users/viniciusgribas/Code/github/work/teste_a...   \\n1  batch1-0002.jpg  /Users/viniciusgribas/Code/github/work/teste_a...   \\n2  batch1-0003.jpg  /Users/viniciusgribas/Code/github/work/teste_a...   \\n3  batch1-0004.jpg  /Users/viniciusgribas/Code/github/work/teste_a...   \\n4  batch1-0005.jpg  /Users/viniciusgribas/Code/github/work/teste_a...   \\n5  batch1-0006.jpg  /Users/viniciusgribas/Code/github/work/teste_a...   \\n6  batch1-0007.jpg  /Users/viniciusgribas/Code/github/work/teste_a...   \\n7  batch1-0008.jpg  /Users/viniciusgribas/Code/github/work/teste_a...   \\n8  batch1-0009.jpg  /Users/viniciusgribas/Code/github/work/teste_a...   \\n9  batch1-0010.jpg  /Users/viniciusgribas/Code/github/work/teste_a...   \\n\\n  file_extension  file_size_kb  \\\\\\n0           .jpg    248.437500   \\n1           .jpg    215.474609   \\n2           .jpg    187.614258   \\n3           .jpg    216.333984   \\n4           .jpg    207.153320   \\n5           .jpg    192.469727   \\n6           .jpg    249.077148   \\n7           .jpg    203.968750   \\n8           .jpg    162.435547   \\n9           .jpg    170.107422   \\n\\n                                        cleaned_text  pages_count  \\\\\\n0  Invoice no: 51109338 Date of issue: Seller: An...            1   \\n1  Invoice no: 12847181 Date of issue: Seller: Fi...            1   \\n2  Invoice no: 19471831 Date of issue: Seller: Pa...            1   \\n3  Invoice no: 16273983 Date of issue: Seller: Re...            1   \\n4  Invoice no: 89969473 Date of issue: Seller: Jo...            1   \\n5  Invoice no: 72128555 Date of issue: Seller: Ob...            1   \\n6  Invoice no: 11580833 Date of issue: Seller: Wo...            1   \\n7  Invoice no: 74589240 Date of issue: Seller: Ha...            1   \\n8  Invoice no: 81978187 Date of issue: Seller: Pa...            1   \\n9  Invoice no: 99314100 Date of issue: 06/25/2014...            1   \\n\\n   extraction_method  text_length  success error  \\n0  OCR (pytesseract)         1198     True  None  \\n1  OCR (pytesseract)          976     True  None  \\n2  OCR (pytesseract)          810     True  None  \\n3  OCR (pytesseract)         1008     True  None  \\n4  OCR (pytesseract)          944     True  None  \\n5  OCR (pytesseract)          786     True  None  \\n6  OCR (pytesseract)         1200     True  None  \\n7  OCR (pytesseract)          907     True  None  \\n8  OCR (pytesseract)          587     True  None  \\n9  OCR (pytesseract)          649     True  None  \", \"success\": true, \"errors\": []}"}}, {"trace_id": "AphxFhouUBwkNavWmwDRlw==", "span_id": "eRXpIyp+peY=", "parent_span_id": "kBTIScGZOrU=", "name": "extract_receipts", "start_time_unix_nano": 1762294479967216000, "end_time_unix_nano": 1762294484408886000, "events": [], "status": {"code": "STATUS_CODE_OK", "message": ""}, "attributes": {"mlflow.traceRequestId": "\"tr-029871161a2e501c2435abd69b00d197\"", "mlflow.spanType": "\"CHAIN\"", "mlflow.spanInputs": "{\"contract_input_path\": \"/Users/viniciusgribas/Code/github/work/teste_alvorada_dev/data/input/jordan_book\", \"invoice_input_path\": \"/Users/viniciusgribas/Code/github/work/teste_alvorada_dev/data/input/invoice_dataset\", \"receipt_input_path\": \"/Users/viniciusgribas/Code/github/work/teste_alvorada_dev/data/input/receipts_dataset\"}", "metadata": "{\"langgraph_step\": 1, \"langgraph_node\": \"extract_receipts\", \"langgraph_triggers\": [\"branch:to:extract_receipts\"], \"langgraph_path\": [\"__pregel_pull\", \"extract_receipts\"], \"langgraph_checkpoint_ns\": \"extract_receipts:0be24a9d-5798-4bfc-0d86-ddb4c4c68a65\"}", "mlflow.spanOutputs": "{\"receipts_df\": \"   filename                                          file_path file_extension  \\\\\\n0     0.jpg  /Users/viniciusgribas/Code/github/work/teste_a...           .jpg   \\n1     1.jpg  /Users/viniciusgribas/Code/github/work/teste_a...           .jpg   \\n2    10.jpg  /Users/viniciusgribas/Code/github/work/teste_a...           .jpg   \\n3     2.jpg  /Users/viniciusgribas/Code/github/work/teste_a...           .jpg   \\n4     3.jpg  /Users/viniciusgribas/Code/github/work/teste_a...           .jpg   \\n5     4.jpg  /Users/viniciusgribas/Code/github/work/teste_a...           .jpg   \\n6     5.jpg  /Users/viniciusgribas/Code/github/work/teste_a...           .jpg   \\n7     6.JPG  /Users/viniciusgribas/Code/github/work/teste_a...           .JPG   \\n8     7.jpg  /Users/viniciusgribas/Code/github/work/teste_a...           .jpg   \\n9     8.jpg  /Users/viniciusgribas/Code/github/work/teste_a...           .jpg   \\n10    9.jpg  /Users/viniciusgribas/Code/github/work/teste_a...           .jpg   \\n\\n    file_size_kb                                       cleaned_text  \\\\\\n0     125.429688  WAL*MART ALWAYS LOW PRICES. ps SUPERCENTER OPE...   \\n1     569.359375  TRADER JOE'S 2001 Greenville Ave Dallas TX 752...   \\n2     737.197266  q si SHIER Ni pping With Us! Thank Seameeeravi...   \\n3     292.270508  Give us feedback @ survey.walmart.com Thank yo...   \\n4     320.632812  See baci $8 ce to-win Sigg\\\" Seeirt for iia TD ...   \\n5     236.141602  Walmart >'< Save money. Live better. 2) 366 ~ ...   \\n6    5270.417969  Sunnyvale SVL 40% 419 1290 150 E Mc Kinley Ave...   \\n7     985.423828  MOMI & TOY’S CREPERIE Tees Mall Kemang, L. ema...   \\n8     353.867188  See back of receip’ to win $1000 ID #: 7L2T9WJ...   \\n9     268.444336  Thornton #629 16375 N. Washington St. Thornton...   \\n10    266.777344  Yolanta cashier 09/08/14 30148200000 hy. 30148...   \\n\\n    pages_count  extraction_method  text_length  success error  \\n0             1  OCR (pytesseract)          304     True  None  \\n1             1  OCR (pytesseract)          765     True  None  \\n2             1  OCR (pytesseract)           52     True  None  \\n3             1  OCR (pytesseract)          660     True  None  \\n4             1  OCR (pytesseract)          496     True  None  \\n5             1  OCR (pytesseract)          530     True  None  \\n6             1  OCR (pytesseract)          920     True  None  \\n7             1  OCR (pytesseract)          447     True  None  \\n8             1  OCR (pytesseract)          787     True  None  \\n9             1  OCR (pytesseract)          574     True  None  \\n10            1  OCR (pytesseract)          527     True  None  \", \"success\": true, \"errors\": []}"}}, {"trace_id": "AphxFhouUBwkNavWmwDRlw==", "span_id": "TLold11/2Qc=", "parent_span_id": "eRXpIyp+peY=", "name": "extract_receipts_node", "start_time_unix_nano": 1762294479967410000, "end_time_unix_nano": 1762294484407624000, "events": [], "status": {"code": "STATUS_CODE_OK", "message": ""}, "attributes": {"mlflow.traceRequestId": "\"tr-029871161a2e501c2435abd69b00d197\"", "mlflow.spanType": "\"UNKNOWN\"", "mlflow.spanFunctionName": "\"extract_receipts_node\"", "mlflow.spanInputs": "{\"state\": {\"contract_input_path\": \"/Users/viniciusgribas/Code/github/work/teste_alvorada_dev/data/input/jordan_book\", \"invoice_input_path\": \"/Users/viniciusgribas/Code/github/work/teste_alvorada_dev/data/input/invoice_dataset\", \"receipt_input_path\": \"/Users/viniciusgribas/Code/github/work/teste_alvorada_dev/data/input/receipts_dataset\"}}", "mlflow.spanOutputs": "{\"receipts_df\": \"   filename                                          file_path file_extension  \\\\\\n0     0.jpg  /Users/viniciusgribas/Code/github/work/teste_a...           .jpg   \\n1     1.jpg  /Users/viniciusgribas/Code/github/work/teste_a...           .jpg   \\n2    10.jpg  /Users/viniciusgribas/Code/github/work/teste_a...           .jpg   \\n3     2.jpg  /Users/viniciusgribas/Code/github/work/teste_a...           .jpg   \\n4     3.jpg  /Users/viniciusgribas/Code/github/work/teste_a...           .jpg   \\n5     4.jpg  /Users/viniciusgribas/Code/github/work/teste_a...           .jpg   \\n6     5.jpg  /Users/viniciusgribas/Code/github/work/teste_a...           .jpg   \\n7     6.JPG  /Users/viniciusgribas/Code/github/work/teste_a...           .JPG   \\n8     7.jpg  /Users/viniciusgribas/Code/github/work/teste_a...           .jpg   \\n9     8.jpg  /Users/viniciusgribas/Code/github/work/teste_a...           .jpg   \\n10    9.jpg  /Users/viniciusgribas/Code/github/work/teste_a...           .jpg   \\n\\n    file_size_kb                                       cleaned_text  \\\\\\n0     125.429688  WAL*MART ALWAYS LOW PRICES. ps SUPERCENTER OPE...   \\n1     569.359375  TRADER JOE'S 2001 Greenville Ave Dallas TX 752...   \\n2     737.197266  q si SHIER Ni pping With Us! Thank Seameeeravi...   \\n3     292.270508  Give us feedback @ survey.walmart.com Thank yo...   \\n4     320.632812  See baci $8 ce to-win Sigg\\\" Seeirt for iia TD ...   \\n5     236.141602  Walmart >'< Save money. Live better. 2) 366 ~ ...   \\n6    5270.417969  Sunnyvale SVL 40% 419 1290 150 E Mc Kinley Ave...   \\n7     985.423828  MOMI & TOY’S CREPERIE Tees Mall Kemang, L. ema...   \\n8     353.867188  See back of receip’ to win $1000 ID #: 7L2T9WJ...   \\n9     268.444336  Thornton #629 16375 N. Washington St. Thornton...   \\n10    266.777344  Yolanta cashier 09/08/14 30148200000 hy. 30148...   \\n\\n    pages_count  extraction_method  text_length  success error  \\n0             1  OCR (pytesseract)          304     True  None  \\n1             1  OCR (pytesseract)          765     True  None  \\n2             1  OCR (pytesseract)           52     True  None  \\n3             1  OCR (pytesseract)          660     True  None  \\n4             1  OCR (pytesseract)          496     True  None  \\n5             1  OCR (pytesseract)          530     True  None  \\n6             1  OCR (pytesseract)          920     True  None  \\n7             1  OCR (pytesseract)          447     True  None  \\n8             1  OCR (pytesseract)          787     True  None  \\n9             1  OCR (pytesseract)          574     True  None  \\n10            1  OCR (pytesseract)          527     True  None  \", \"success\": true, \"errors\": []}"}}]}